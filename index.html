<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <script>
      // EMERGENCY ERROR HANDLER
      window.onerror = function(msg, url, line, col, error) {
        showError('Erro Global: ' + msg + '\n' + (error ? error.stack : ''));
      };
      window.onunhandledrejection = function(event) {
        showError('Promessa Rejeitada: ' + event.reason);
      };
      
      function showError(text) {
        const el = document.getElementById('debug-overlay') || document.createElement('div');
        el.id = 'debug-overlay';
        el.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;z-index:99999;background:white;color:red;padding:20px;overflow:auto;font-family:monospace;font-size:12px;';
        
        const content = document.createElement('pre');
        content.textContent = text;
        
        const btn = document.createElement('button');
        btn.textContent = 'LIMPAR CACHE & RESETAR APP';
        btn.style.cssText = 'padding:15px;background:red;color:white;border:none;border-radius:8px;margin-bottom:20px;width:100%;font-weight:bold;font-size:14px;';
        btn.onclick = function() {
           navigator.serviceWorker.getRegistrations().then(function(registrations) {
            for(let registration of registrations) { registration.unregister(); }
          });
          localStorage.clear();
          sessionStorage.clear();
          caches.keys().then(function(names) {
            for (let name of names) caches.delete(name);
          });
          alert('Limpeza concluída. O app será recarregado.');
          window.location.reload();
        };
        
        el.innerHTML = '';
        el.appendChild(btn);
        el.appendChild(content);
        document.body.appendChild(el);
      }
    </script>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SolidGo</title>
    <script type="module">
      if (import.meta.hot?.on) {
        import.meta.hot.on('vite:error', (error) => {
          if (error.err) {
            console.error(
              [error.err.message, error.err.frame].filter(Boolean).join('\n'),
            )
          }
        })
      }
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
